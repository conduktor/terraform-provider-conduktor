---
page_title: "Conduktor : gateway_interceptor_v2 "
subcategory: "gateway/v2"
description: |-
    Resource for managing Conduktor Gateway Interceptors.
    This resource allows you to create, read, update and delete interceptors in Conduktor Gateway.
    For a full description of what Gateway interceptors are, refer to our [docs site](https://docs.conduktor.io/gateway/reference/resources-reference/#interceptor).
---

# conduktor_gateway_interceptor_v2

Resource for managing Conduktor interceptors.
This resource allows you to create, read, update and delete interceptors in Conduktor Gateway.

## Example Usage

### Simple CreateTopicPolicyPlugin interceptor using jsonencode config
```terraform
resource "conduktor_gateway_interceptor_v2" "topic-policy" {
  name = "enforce-partition-limit"
  spec {
    plugin_class = "io.conduktor.gateway.interceptor.safeguard.CreateTopicPolicyPlugin"
    priority     = 1
    config = jsonencode({
      topic = "myprefix-.*"
      numPartition = {
        min    = 5
        max    = 5
        action = "INFO"
      }
    })
  }
}
```

### Example EncryptPlugin interceptor using jsonencode config
```terraform
resource "conduktor_gateway_interceptor_v2" "field-encryption" {
  name = "field-encryption"
  spec {
    plugin_class = "io.conduktor.gateway.interceptor.EncryptPlugin"
    priority     = 1
    config = jsonencode({
      "topic" = "encrypt.*"
      "kmsConfig" = {
        "vault" = {
          "uri"     = "http://vault:8200"
          "token"   = "test"
          "version" = 1
        }
      }
      "recordValue" = {
        "fields" = [
          {
            "fieldName"   = "password"
            "keySecretId" = "vault-kms://vault:8200/transit/keys/password-secret"
            "algorithm"   = "AES128_GCM"
          },
          {
            "fieldName"   = "visa"
            "keySecretId" = "vault-kms://vault:8200/transit/keys/{{record.header.test-header}}-visa-secret-{{record.key}}-{{record.value.username}}-{{record.value.education.account.accountId}}"
            "algorithm"   = "AES128_GCM"
          },
          {
            "fieldName"   = "education.account.username"
            "keySecretId" = "in-memory-kms://myDefaultKeySecret"
            "algorithm"   = "AES128_GCM"
          }
        ]
      }
    })
  }
}
```

### Example MessageHeaderRemovalPlugin interceptor using raw json string config
This example shows that you can use raw json string as config for the interceptor and use terraform functions
jsondecode and jsonencode to nornamize the JSON in terraform state.
```terraform
resource "conduktor_gateway_interceptor_v2" "header-removal" {
  name = "remove-headers"
  spec {
    plugin_class = "io.conduktor.gateway.interceptor.safeguard.MessageHeaderRemovalPlugin"
    priority     = 100
    config = jsonencode(jsondecode(<<EOF
{
  "topic": "topic-.*",
  "headerKeyRegex": "headerKey.*"
}
EOF
    ))
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The name of the interceptor, must be unique, act as ID for import

### Optional

- `scope` (Block, Optional) (see [below for nested schema](#nestedblock--scope))
- `spec` (Block, Optional) (see [below for nested schema](#nestedblock--spec))

<a id="nestedblock--scope"></a>
### Nested Schema for `scope`

Optional:

- `group` (String) The name of the group the interceptor will be applied to. Optional parameter to helps defining the scope
- `username` (String) The username the interceptor will be applied to. Optional parameter to helps defining the scope
- `vcluster` (String) The name of the virtual cluster the interceptor will be applied to. Optional parameter to help defining the scope


<a id="nestedblock--spec"></a>
### Nested Schema for `spec`

Required:

- `config` (String) Plugin configuration in JSON format. Check [interceptor catalog](https://docs.conduktor.io/gateway/category/interceptor-catalog/) for details on the configuration
- `plugin_class` (String) The class of the plugin. Check [interceptor catalog](https://docs.conduktor.io/gateway/category/interceptor-catalog/) for available plugins
- `priority` (Number) The priority of the interceptor. Must be bigger than 0

Optional:

- `comment` (String) An optional comment for the interceptor.




## Import

In order to import an existing Conduktor Gateway interceptor, you need to know the interceptor unique name.

The import ID is constructed as follows: `< interceptor_name >`.

For example, using an [`import` block](https://developer.hashicorp.com/terraform/language/import) :
```terraform
import {
  to = conduktor_gateway_interceptor_v2.example
  id = "interceptor-name" # Import "interceptor-name" Interceptor
}
```

Using the `terraform import` command:
```shell
terraform import conduktor_gateway_interceptor_v2.example interceptor-name
```
