---
page_title: "Conduktor : gateway_interceptor_v2 "
subcategory: "gateway/v2"
description: |-
    Resource for managing Conduktor Gateway Interceptors.
    This resource allows you to create, read, update and delete interceptors in Conduktor Gateway.
    For a full description of what Gateway interceptors are, refer to our [docs site](https://docs.conduktor.io/gateway/reference/resources-reference/#interceptor).
---

# conduktor_gateway_interceptor_v2

Resource for managing Conduktor interceptors.

This resource allows you to create, read, update and delete interceptors in Conduktor Gateway.

## Example Usage

### Simple CreateTopicPolicyPlugin interceptor using jsonencode config
```terraform
resource "conduktor_gateway_interceptor_v2" "topic-policy" {
  name = "enforce-partition-limit"
  scope = {
    vcluster = "passthrough"
  }
  spec = {
    plugin_class = "io.conduktor.gateway.interceptor.safeguard.CreateTopicPolicyPlugin"
    priority     = 1
    config = jsonencode({
      topic = "myprefix-.*"
      numPartition = {
        min    = 5
        max    = 5
        action = "INFO"
      }
    })
  }
}
```

### Example EncryptPlugin interceptor using jsonencode config
```terraform
resource "conduktor_gateway_interceptor_v2" "field-encryption" {
  name = "field-encryption"
  scope = {
    vcluster = "passthrough"
    username = "my.user"
  }
  spec = {
    plugin_class = "io.conduktor.gateway.interceptor.EncryptPlugin"
    priority     = 1
    config = jsonencode({
      "topic" = "encrypt.*"
      "kmsConfig" = {
        "vault" = {
          "uri"     = "http://vault:8200"
          "token"   = "test"
          "version" = 1
        }
      }
      "recordValue" = {
        "fields" = [
          {
            "fieldName"   = "password"
            "keySecretId" = "vault-kms://vault:8200/transit/keys/password-secret"
            "algorithm"   = "AES128_GCM"
          },
          {
            "fieldName"   = "visa"
            "keySecretId" = "vault-kms://vault:8200/transit/keys/{{record.header.test-header}}-visa-secret-{{record.key}}-{{record.value.username}}-{{record.value.education.account.accountId}}"
            "algorithm"   = "AES128_GCM"
          },
          {
            "fieldName"   = "education.account.username"
            "keySecretId" = "in-memory-kms://myDefaultKeySecret"
            "algorithm"   = "AES128_GCM"
          }
        ]
      }
    })
  }
}
```

### Example MessageHeaderRemovalPlugin interceptor using raw json string config
This example shows that you can use raw json string as config for the interceptor and use terraform functions
jsondecode and jsonencode to nornamize the JSON in terraform state.
```terraform
resource "conduktor_gateway_interceptor_v2" "header-removal" {
  name = "remove-headers"
  spec = {
    plugin_class = "io.conduktor.gateway.interceptor.safeguard.MessageHeaderRemovalPlugin"
    priority     = 100
    config = jsonencode(jsondecode(<<EOF
      {
        "topic": "topic-.*",
        "headerKeyRegex": "headerKey.*"
      }
      EOF
    ))
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The name of the interceptor, must be unique, acts as an ID for import
- `spec` (Attributes) The interceptor specification (see [below for nested schema](#nestedatt--spec))

### Optional

- `scope` (Attributes) The targeting scope of the interceptor. See [documentation](https://docs.conduktor.io/gateway/reference/resources-reference/#interceptor-targeting) (see [below for nested schema](#nestedatt--scope))

<a id="nestedatt--spec"></a>
### Nested Schema for `spec`

Required:

- `config` (String) Plugin configuration in JSON format. Check the [interceptor catalog](https://docs.conduktor.io/gateway/category/interceptor-catalog/) for details on the configuration
- `plugin_class` (String) The class of the plugin. Check the [interceptor catalog](https://docs.conduktor.io/gateway/category/interceptor-catalog/) for available plugins
- `priority` (Number) The priority of the interceptor. Must be greater than 0

Optional:

- `comment` (String) An optional comment for the interceptor.


<a id="nestedatt--scope"></a>
### Nested Schema for `scope`

Optional:

- `group` (String) The name of the group the interceptor will be applied to. Optional parameter for defining the scope
- `username` (String) The username the interceptor will be applied to. Optional parameter for defining the scope
- `vcluster` (String) The name of the virtual cluster the interceptor will be applied to. Optional parameter for defining the scope




## Import

In order to import an existing Conduktor Gateway interceptor, you need to know the interceptor's unique name.

The import ID is constructed as follows: `<interceptor_name>/<vcluster>/<group>/<username>`.

If optional `group` or `username` are not part of interceptor state, they can be replaced by empty string or `null` in the import ID.

Like this: `<interceptor_name>/<vcluster>//<username>` or `<interceptor_name>/<vcluster>/<group>/null`.

For example, using an [`import` block](https://developer.hashicorp.com/terraform/language/import) :
```terraform
import {
  to = conduktor_gateway_interceptor_v2.example
  id = "interceptor-name/vcluster_sa//my.user" # Import <interceptor_name>/<vcluster>/<group>/<username> Interceptor
}
```

Using the `terraform import` command:
```shell
terraform import conduktor_gateway_interceptor_v2.example interceptor-name
```
